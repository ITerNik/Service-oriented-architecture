global
    log stdout local0
    log stdout local1 notice
    user haproxy
    group haproxy

    ca-base /etc/ssl/certs
    crt-base /etc/ssl/private

    ssl-default-bind-ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256
    ssl-default-bind-options ssl-min-ver TLSv1.2 no-tls-tickets

defaults
    log     global
    mode    http
    option  httplog
    option  dontlognull
    timeout connect 5000
    timeout client  50000
    timeout server  50000

frontend https_in
    bind *:8443 ssl crt /etc/haproxy/certs/combined.pem
    mode http
    option httpclose
    option forwardfor
    
    log global
    
    default_backend web2_backend

backend web2_backend
    mode http
    balance roundrobin
    option httpchk GET /health
    server web21 web21:8080 check inter 5s rise 2 fall 3
    server web22 web22:8080 check inter 5s rise 2 fall 3
